@model EventsMS.Models.Payment

@{
    ViewData["Title"] = Model.Id == 0 ? "Create New Payment" : "Edit Payment";
}

<!-- Header -->
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="fw-bold mb-0">@ViewData["Title"]</h2>
    <a asp-action="Index" class="btn btn-outline-secondary rounded-pill px-4">
        <i class="bi bi-arrow-left me-1"></i> Back to List
    </a>
</div>

<!-- Form Card -->
<div class="chart-card p-4 p-md-5">
    <!-- Reuse chart-card class for consistent card look -->
    <form asp-action="CreateOrEdit" method="post">
        <input type="hidden" asp-for="Id" />

        <div class="row g-4">
            <!-- Invoice Number -->
            <div class="col-md-6">
                <label asp-for="InvoiceNumber" class="form-label fw-medium">Invoice Number</label>
                <div class="input-group input-group-merge">
                    <span class="input-group-text"><i class="bi bi-receipt"></i></span>
                    <input asp-for="InvoiceNumber" class="form-control" placeholder="e.g. INV-2026001" />
                </div>
                <div class="invalid-feedback">
                    <span asp-validation-for="InvoiceNumber"></span>
                </div>
            </div>

            <!-- Student (Registration) -->
            <div class="col-md-6">
                <label asp-for="RegistrationId" class="form-label fw-medium">Student</label>
                <select asp-for="RegistrationId" class="form-select" asp-items="ViewBag.RegistrationId" required>
                    <option value="">-- Select Student --</option>
                </select>
                <div class="invalid-feedback">
                    <span asp-validation-for="RegistrationId"></span>
                </div>
            </div>

            <!-- Provider -->
            <div class="col-md-6">
                <label asp-for="Provider" class="form-label fw-medium">Payment Provider</label>
                <div class="input-group input-group-merge">
                    <span class="input-group-text"><i class="bi bi-bank"></i></span>
                    <input asp-for="Provider" class="form-control" placeholder="e.g. bKash, Nagad, Stripe" />
                </div>
            </div>

            <!-- Status -->
            <div class="col-md-6">
                <label asp-for="Status" class="form-label fw-medium">Status</label>
                <select asp-for="Status" class="form-select">
                    <option value="Pending">Pending</option>
                    <option value="Paid">Paid</option>
                    <option value="Failed">Failed</option>
                    <option value="Refunded">Refunded</option>
                </select>
            </div>

            <!-- Amount -->
            <div class="col-md-6">
                <label asp-for="Amount" class="form-label fw-medium">Amount (BDT)</label>
                <div class="input-group input-group-merge">
                    <span class="input-group-text">৳</span>
                    <input asp-for="Amount" class="form-control" type="number" step="0.01" placeholder="0.00" />
                </div>
                <div class="invalid-feedback">
                    <span asp-validation-for="Amount"></span>
                </div>
            </div>

            <!-- Transaction ID -->
            <div class="col-md-6">
                <label asp-for="TransactionId" class="form-label fw-medium">Transaction ID</label>
                <input asp-for="TransactionId" class="form-control" placeholder="e.g. TXN123456789" />
            </div>

            <!-- Provider Session ID -->
            <div class="col-md-6">
                <label asp-for="ProviderSessionId" class="form-label fw-medium">Provider Session ID</label>
                <input asp-for="ProviderSessionId" class="form-control" placeholder="(optional)" />
            </div>

            <!-- Validation ID -->
            <div class="col-md-6">
                <label asp-for="ValidationId" class="form-label fw-medium">Validation ID</label>
                <input asp-for="ValidationId" class="form-control" placeholder="(optional)" />
            </div>
        </div>

        <!-- Form Actions -->
        <div class="d-flex gap-3 mt-5 pt-4 border-top">
            <button type="submit" class="btn btn-primary rounded-pill px-5 py-2 fw-semibold">
                <i class="bi bi-check-lg me-1"></i>
                @(Model.Id == 0 ? "Create Payment" : "Update Payment")
            </button>
            <a asp-action="Index" class="btn btn-outline-secondary rounded-pill px-5 py-2">
                Cancel
            </a>
        </div>
    </form>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }

    <script>
        // Optional: Client-side enhancement (e.g., auto-focus first field)
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelector('input[autofocus]')?.focus() || document.querySelector('input.form-control')?.focus();
        });
    </script>
}